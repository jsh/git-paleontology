#!/bin/bash -eu

# Not quite, but close

find-first-with() {
  git tag -f bad HEAD &> /dev/null
  git bisect start bad initial &>/dev/null
  git checkout -q bad
  git bisect run [ ! -f $1 ] &> /dev/null
  [ -f $1 ] || git checkout -q -
  git rev-parse HEAD
  git checkout -q HEAD^
  return
}
  

# initialize state
git tag -d $(git tag -l first*)
git tag -f good $(git rev-list master | tail -1)

# now find everything
git tag first-git-dot-c $(find-first-with git.c)
git tag first-git-dot-sh $(find-first-with git.sh)
git tag first-git-cmd $(find-first-with git)

# and list it
git checkout master
for i in initial first-git-cmd first-git-dot-sh first-git-dot-c; do
  d=$(git log -1 --date=short --pretty=format:%cD $i)
  echo $i: $d
done
